<html lang="en">
<head>
    <%- include('partials/head'); %>
</head>
<body>
<div id="main">
    <h2 id="title" class="page-header">User Accounts</h2>
    <%- include('partials/nav_bar', { selection: 5, pid: pid }); %>
    <div id="toast"></div>
    <div id="wrapper">
		<div class="buttons tabs">
			<a id="post-reports" href="/admin/posts">Posts</a>
			<a id="account-reports" class="selected" href="/admin/accounts">Accounts</a>
		</div>
        <% if(users.length === 0) {%>
            <p>No Users found</p>
        <%} else { %>
        <ul class="list-content-with-icon-and-text arrow-list" id="news-list-content">
            <% users.forEach(function(user) { %>
				<li>
					<div class="hover">
						<a href="/users/<%= user.pid %>" data-pjax="#body" class="icon-container notify">
							<img src="https://pretendo-cdn.b-cdn.net/mii/<%= user.pid %>/normal_face.png" class="icon">
						</a>
						<a class="body" href="/users/<%= user.pid %>">
							<span class="text"><span class="nick-name"><%= userMap.get(user.pid) %></span>
						</a>
					</div>
					<button onclick="this.children[0].click()"><a id="account-<%= user.pid %>" href="/admin/accounts/<%=user.pid%>">Manage User</a></button>
				</li>
            <% });} %>
        </ul>
    </div>
</div>
<script>
    function remove(element) {
        const id = element.getAttribute("data-id");
        const reason = prompt("Provide explanation for removing post:")
        if(!id || !reason) return;

        fetch(`/admin/${id}?reason=${reason}`, {
            method: 'DELETE',
        })
            .then(res => res.text())
            .then(res => location.reload())
    }
	function ignore(element) {
        const id = element.getAttribute("data-id");
        const reason = prompt("Provide explanation for ignoring this report:")
        if(!id || !reason) return;

        fetch(`/admin/${id}?reason=${reason}`, {
            method: 'PUT',
        })
            .then(res => res.text())
            .then(res => location.reload())
    }
</script>
</body>
</html>
